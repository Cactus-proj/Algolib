# Copyright (C) 1991--2013 by INRIA.
#
# This file is part of Algolib.
#
# Algolib is free software: you can redistribute it and/or modify it
# under the terms of the GNU Lesser General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.
#
# Algolib is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with Algolib.  If not, see
# <http://www.gnu.org/licenses/>.

A := Ore_algebra:-diff_algebra([dx, x]):
L := [-2-2*x, 0, (1+x)^3]:
r := Mgfun:-MG_Internals:-LOE_rat(A, L, x):

if r[1] <> 0 and normal(add(L[i+1]*diff(r[1], [x$i]), i=0..nops(L)-1)) = 0 and
   denom(r[1]) <> 1 then
  okay
else
  r
end if;

A := Ore_algebra:-diff_algebra([dx, x], [ds, s], [dt, t]):
L := [-(-s*t+2*s^2*t+2*t^2+2*x*s-3*s*t^2-3*x*t-3*x*s^2+4*x*s*t)*(-1+s)*(-8*x*s*t^2-4*t*x*s^3+4*x^2*s*t^2-8*t*x^2*s^2+12*t^2*x*s^2+6*x^2*s*t-6*x*s*t^3+2*t*x*s^2-s^2*t^2+4*s*t^3-2*x^2*s^2-6*s^2*t^3+3*s*t^4+4*x*t^3-3*x^2*t^2+2*s^3*t^2+3*x^2*s^3-2*t^4), (s-t)*(-1+s)*(t-x)*t*(-s*t+2*s^2*t+2*t^2+2*x*s-3*s*t^2-3*x*t-3*x*s^2+4*x*s*t)^2]:
eta := [(s-t)*(-1+s)*(t-x)*t*(-s*t+2*s^2*t+2*t^2+2*x*s-3*s*t^2-3*x*t-3*x*s^2+4*x*s*t)^2, (-s*t+2*s^2*t+2*t^2+2*x*s-3*s*t^2-3*x*t-3*x*s^2+4*x*s*t)*(s-t)^2*(-1+s)^2*t^2, 2*(s-t)^2*(-1+s)^2*t^2*(-2*s+3*t+3*s^2-4*s*t)]:
r := Mgfun:-MG_Internals:-LOE_rat(A, L, t, 0, eta):
if r[1] <> 0 and normal(add(L[i+1]*diff(r[1], [t$i]), i=0..nops(L)-1)-
   add(eta[i]*eval(Eta[i-1], r[2]), i=1..nops(eta))) = 0 then
  okay
else
  r
end if;
